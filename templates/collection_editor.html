{% extends 'basis.html' %}
{% block title %}Collection Editor{% endblock %}
{% block pageheader %}Collection Editor{% endblock %}
{% block content %}
    {% if content %}
    <a href="{{ url_for('routes.display_collection',title=content['internal_title']) }}">View collection &raquo;</a>
    {% endif %}
    <h3>Meta</h3>
    <form>
        <label for="title">Title</label>
        <input id="title"
         {% if content %}
                value="{{ content['title'] }}"
               {% endif %}
        />
        <label for="description">Description</label>
        <textarea id="description">{% if content %}{{ content['description'] }}{% endif %}</textarea>
    </form>
    <h3>Sequence</h3>
    <div id="collection_sequencer">
        <ul id="authors">
            {% for author in authors %}
                <li>
                    <button onclick="listComicsByAuthor({{ author['user_id'] }})">{{ author['full_name'] }}</button>
                </li>
            {% endfor %}
        </ul>
        <ul id="comic_menu" class="sortable js-sortable-menu">
        </ul>
        <ul id="collection_sequence" class="sortable js-sortable-sequencer">

        </ul>

    </div>
    <button type="submit" onclick="postCollection()"
    {% if content %}data-id="{{ content['collection_id'] }}"{% else %}data-id=""{% endif %}
    id="submit_button" >Post Collection</button>

    <template id="comic_menu_listing">
        <li draggable="true"><span></span><a href="" target="_blank" rel="noopener noreferrer">View</a>
        <button type="button" title="delete" class="delete" onclick="remove_from_list(this)">&times;</button> </li>
    </template>


    <script src="{{ url_for('static',filename='common.js') }}"></script>
    <script src="{{ url_for('static', filename='html5sortable.js') }}"></script>
    <script>
        sortable('.js-sortable-menu', {
            acceptFrom: false,
            copy: true,
            placeholderClass: 'sort_placeholder',
            hoverClass: 'sort_hover',
        });
        sortable('.js-sortable-sequencer', {
            acceptFrom: '.js-sortable-menu, .js-sortable-sequencer',

            //forcePlaceholderSize: true,
            placeholderClass: 'sort_placeholder',
            hoverClass: 'sort_hover',
        });
    </script>

    <script src="{{ url_for('static',filename='collection_editor.js') }}"></script>

    {% if content %}
    <script>
    document.onload = initialize_editor({{ content.sequence | safe }})
    </script>
    {% endif %}

{% endblock %}